1. Liste o nome, sobrenome e dia dos funcionários aniversariantes do mês de março.
select surname, forenames, day(dob) from employee where month(dob) = 03;

2. Liste o nome de todos os funcionários que assumiram o cargo de contador (Accountant) em
1980.
select surname,startdate from employee natural join jobhistory where position = 'Accountant' and year(startdate) = 1980;

3. Um funcionário, durante seu tempo de trabalho na empresa, pode assumir diferentes cargos.
Para todo cargo é registrado a data que o funcionário assumiu e a data que ele saiu do
cargo, caso tenha saído. Não é permitido que um funcionário tenha mais de um cargo ativo.
Se um funcionário não faz mais parte da equipe da empresa, então todos os cargos que
esse já assumiu estarão obrigatoriamente com data que ele saiu do cargo.
Fazendo uso de subconsulta, liste o número e nome de todos os funcionários que ainda
trabalham na empresa.
select empno, surname from employee where empno in (select empno from jobhistory where enddate is NULL);

4. Liste o nome e o cargo atual de todos os funcionários.
select surname, position from employee natural join jobhistory f where f.enddate is NULL;

5. Liste o total de salários agrupados por departamento
select dname, sum(r.salary) as total from department natural join (select empno, depno, salary from employee natural join jobhistory f where f.enddate is NULL) as r group by dname;

6. Liste o total da folha de pagamento
select sum(r.salary) as total from department natural join (select empno, depno, salary from employee natural join jobhistory f where f.enddate is NULL) as r;

7. Fazendo uso de subconsulta, liste o número, nome e sobrenome de todos os funcionários que nunca fizeram um curso
select empno, surname, forenames from employee where empno not in (select empno from empcourse);

8. Fazendo uso de subconsulta, liste os nomes das pessoas que fizeram algum curso em 1988.
select surname from employee e where e.empno in (select empno from empcourse natural join course where year(cdate) = 1988);

9. Liste o nome do departamento e o total de funcionários de cada departamento
select dname, count(*) as total from department natural join employee group by dname;
select dname, count(*) as total from department natural join employee natural join jobhistory where enddate is NULL group by dname;

10. Liste o total de pessoas, agrupadas por departamento que fez cada curso. É necessário listar o nome do departamento, nome do curso e o total de pessoas que fez esse curso.
select dname, cname, count(*) as total from course natural join empcourse natural join department natural join employee group by dname, cname;

11. Para cada departamento, liste o maior salário.
select dname, max(salary) from department natural join employee natural join jobhistory group by dname;

12. Dos maiores salários encontrados no exercício anterior, liste o menor deles.
select min(maxsal) from (select dname, max(salary) as maxsal from department natural join employee natural join jobhistory group by dname) as r;

13. Migre todos os funcionários do departamento accounts para o departamento engineering.
Você só deve usar os nomes dos departamentos (dname) e não poderá referenciar diretamente os códigos dos departamentos (depno).

update employee set depno = (select depno from department where dname = 'accounts') where depno = (select depno from department where dname = 'engineering');


14. Exclua todos os funcionários que estejam lotados no departamento accounts. Você deve usar o nome do departamento.
delete from employee where depno = (select depno from department where dname = 'accounts');

15. Exclua todos os funcionários que estejam lotados no departamento engineering. Você
deve usar o nome do departamento.
delete from employee where depno = (select depno from department where dname = 'engineering');

=========================================

Parte 2. Esquema Sakila
Para as questões 16– 27, considere a base de dados de uma locadora de DVD (base Sakila1),
cuja modelagem está na última página dessa lista de exercício e sua descrição está disponível
em http://docente.ifsc.edu.br/mello/bcd/labs/lab04-sakila-en.a4.pdf.

16. Liste o nome de todos idiomas em ordem alfabética;
select name from language order by name;

17. Liste o nome e o endereço de todos os clientes que tenham o district vazio.
select first_name, address from customer c inner join address a on c.address_id = a.address_id where a.district = "";

18. Liste o nome de todas as categorias de filmes e o total de filmes por categoria. Ordene o
resultado pelo número de filmes de cada categoria.
select name, count(*) as total from film f inner join film_category fc on f.film_id = fc.film_id inner join category c on fc.category_id = c.category_id group by c.name;

19. Para todos os filmes, liste o título do filme e o nome de sua categoria, ordenado pela categoria.
select title, name from film f inner join film_category fc on f.film_id = fc.film_id inner join category c on fc.category_id = c.category_id order by name;

20. Liste todos os clientes que ainda não alugaram um filme.
select first_name from customer where customer_id not in (select customer_id from rental);

21. Liste o total de cópias de cada filme existente na loja 1.
select title, count(*) from store s inner join inventory i on s.store_id = i.store_id inner join film f on i.film_id = f.film_id where s.store_id = 1 group by f.film_id;

22. Liste todos os dados das locações de DVD da loja 1 e que ainda não foram devolvidos.
select * from rental r inner join customer c on r.customer_id = c.customer_id inner join store s on c.store_id = s.store_id where s.store_id = 1 and return_date is NULL;

23. O cliente 168 devolveu o DVD 4416. Atualize a tabela de aluguéis, inserindo a data de hoje
como data de retorno.
update rental set return_date = now() where customer_id = 168 and inventory_id = 4416;






